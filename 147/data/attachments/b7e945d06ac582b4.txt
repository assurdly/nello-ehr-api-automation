var jsonData = pm.response.json();

pm.test("Response status is success and code is 200", function () {
    pm.response.to.have.status(200);
    pm.expect(jsonData.status).to.eql("success");
});

pm.test("Users array is valid and contains at least one user", function () {
    pm.expect(jsonData.users).to.be.an("array").and.to.have.length.above(0);
});

pm.test("First user details are properly structured", function () {
    let user = jsonData.users[0];

    pm.expect(user._id).to.be.a("string").and.to.not.be.null;
    pm.expect(user.upi).to.be.a("string").and.to.not.be.null;
    pm.expect(user.blood_group).to.be.a("string").and.to.not.be.null;
    pm.expect(user.next_of_kin).to.be.a("string").and.to.not.be.null;
    pm.expect(user.office).to.be.a("string").and.to.not.be.null;
    pm.expect(user.office_uuid).to.be.a("string").and.to.not.be.null;
    pm.expect(user.uuid).to.be.a("string").and.to.not.be.null;
    pm.expect(user.allergies).to.be.an("object").and.to.not.be.null;
});

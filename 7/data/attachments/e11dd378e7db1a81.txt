var jsonData = pm.response.json();

pm.test("Response status code is 403", function () {
    pm.response.to.have.status(403);
});

pm.test("Access denied message is returned", function () {
    pm.expect(jsonData.message).to.eql("Access denied: Admins only");
});

pm.test("User information is included", function () {
    pm.expect(jsonData.user.email).to.be.a("String").and.to.not.be.null;
    pm.expect(jsonData.user.iat).to.be.a("number").and.to.not.be.null;
    pm.expect(jsonData.user.exp).to.be.a("number").and.to.not.be.null;
});

pm.test("User role is unauthorized", function () {
    pm.expect(["Receptionist", "Cashier", "User", "Nurse", "Doctor"]).to.include(jsonData.user.role);
});

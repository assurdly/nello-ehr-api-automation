var jsonData = pm.response.json();

pm.test("Response status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Encounter response structure is valid", function () {
    pm.expect(jsonData.status).to.eql("success");
    pm.expect(jsonData.encounters).to.be.an("array").and.to.have.length.above(0);
});

pm.test("Encounter contains required fields", function () {
    var encounter = jsonData.encounters[0];

    pm.expect(encounter.appointment_uuid).to.be.a("string").and.to.not.be.null;
    pm.expect(encounter.appointment._id).to.be.a("string").and.to.not.be.null;
    pm.expect(encounter.uuid).to.be.a("string").and.to.not.be.null;
    pm.expect(encounter.payment_policy).to.be.a("string").and.to.not.be.null;
    pm.expect(encounter.patient).to.be.a("string").and.to.include("@");
    pm.expect(encounter.consultant).to.be.a("string").and.to.not.be.null;
    pm.expect(encounter.isUrgent).to.be.a("string").and.to.not.be.null;
    pm.expect(encounter.status).to.be.a("string").and.to.not.be.null;
    pm.expect(jsonData.billing_officer).to.be.a("string").and.to.not.be.null;
    });

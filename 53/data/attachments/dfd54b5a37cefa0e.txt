var jsonData = pm.response.json();

pm.test("API should return status code 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Response structure is valid", function () {
    pm.expect(jsonData).to.be.an("object");
    pm.expect(jsonData).to.have.property("status").that.equals("success");
});

pm.test("User details should be present", function () {
    pm.expect(jsonData.data.user).to.be.an("object");
    pm.expect(jsonData.data.user).to.have.property("id").that.is.a("string");
    pm.expect(jsonData.data.user).to.have.property("email").that.includes("@");
    pm.expect(jsonData.data.user).to.have.property("role").that.is.oneOf(["admin", "user", "moderator"]);
});

pm.test("Transaction details should be valid", function () {
    pm.expect(jsonData.data.transaction).to.be.an("object");
    pm.expect(jsonData.data.transaction).to.have.property("amount").that.is.a("number");
    pm.expect(jsonData.data.transaction).to.have.property("currency").that.is.a("string");
    pm.expect(jsonData.data.transaction).to.have.property("status").that.is.oneOf(["pending", "completed", "failed"]);
});


